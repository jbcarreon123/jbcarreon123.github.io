---
import '../styles/global.css' 
import { ClientRouter } from "astro:transitions";
import { version } from '../../package.json';
import { Image } from 'astro:assets';

const { title, id, description } = Astro.props;
const { url, site } = Astro;
import { OgImage } from "astro-opengraph-image/components";

const ogImage = url.toString().replace('/posts/', '/post-og/').replace(/\/$/, "");
---
<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title? title : "jb's site"}</title>
		<meta name="description" content={description} />
		<script src="view-transitions-polyfill"></script>
		<meta name="twitter:card" content="summary_large_image">
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:url" content={url} />
		<meta property="og:type" content={url.pathname.includes('posts') ? 'article' : 'website'} />
		<meta property="twitter:image" content={ogImage + '.png'} />
		<ClientRouter />

		<script is:inline>
			Array.prototype.sample = function(){
				return this[Math.floor(Math.random()*this.length)];
			}
		
			document.addEventListener("astro:page-load", () => {
				setTimeout(() => {
					document.querySelector('.motd').textContent = [
						'ctrl + c and ctrl + v are the most used shortcuts',
						'hello, we\'re trying to reach you for your site\'s extended warranty',
						'nekonekoweb',
						'hmm',
						'your resident helper',
						'made in astro and bun',
						'a person that stares on his text editor'
					].sample();
				}, 250)
		
				document.querySelectorAll('.title').forEach((el) => el.textContent = document.title);
		
				let el = document.querySelector('nav')?.dataset.activePage;
				document.querySelectorAll('nav a').forEach((e) => {
					if (e.id === el) {
						e.classList.add('active')
					} else {
						e.classList.remove('active')
					}
				})
			});
		</script>
	</head>
	<body class="jcolor">
		<header>
			<label for="nav-visible" class="a">Menu</label>
			<p class="title">{title? title : "jb's site"}</p>
			<input type="checkbox" id="nav-visible" />
		</header>
		<div class="container">
			<aside>
				<nav data-active-page={id}>
					<a id="index" href="/"><span class="ms">home</span> Home</a>
					<a id="about" href="/about/"><span class="ms">person</span> About JB</a>
					<a id="posts" href="/posts/"><span class="ms">article</span> Posts</a>
					<a id="tutorials" href="/tutorials/"><span class="ms">help</span> Tutorials</a>
					<a id="riiatw" href="/riiatw/"><span class="ms">language</span> RIIAtW</a>
					<p class="sep">outlinks</p>
					<a id="links" href="/links/"><span class="ms">link</span> Links</a>
					<a id="bookmarks" href="/bookmarks/"><span class="ms">bookmark</span> Bookmarks</a>
					<p class="sep">liked my site?</p>
					<a href="https://jbcarreon123.atabook.org"><span class="ms">contract_edit</span> Sign my Guestbook</a>
					<a href="https://nekoweb.org/follow/jbcarreon123"><span class="ms">add</span> Follow me on Nekoweb!</a>
					<p class="sep">member of</p>
					<a href="https://team.indieseas.net" target="_blank">indiefellas <span class="ms">open_in_new</span></a>
					<a href="https://macro-deck.app" target="_blank">Macro Deck <span class="ms">open_in_new</span></a>
					<link rel="alternate" type="application/rss+xml" title="jb's posts" href={new URL("feed.xml", Astro.site)} />
				</nav>
				<div>
					<h1 class="title">{title? title : "jb's site"}</h1>
					<p class="sec motd">your resident helper</p>
				</div>
			</aside>
			<main>
				<div id="content">
					<slot />
				</div>
				<footer>
					<div class="sec">
						<p class="small">jbsite4@{version} Â© 2025 jbcarreon123. All rights reserved.</p>
						<p class="small">Site content are licensed under CC BY-SA 4.0 unless specified.</p>
						<p class="small">Made in Astro and Bun, hosted in Nekoweb</p>
						<p class="small"><a href="https://maxpixels.moe/manifesto/" target="_blank">Copying is an act of theft, while taking inspiration is the true act of love. <span class="ms">open_in_new</span></a></p>
					</div>
					<div class="right">
						<a target="_blank" rel="noopener" class="w-fit shrink-0" href="https://developer.mozilla.org/en-US/docs/Web/SVG/SVG_animation_with_SMIL">
							<Image src="/imgs/buttons/smil.svg" alt="Enhanced with SMIL :D" title="Enhanced with SMIL :D" width="88px" height="31px" />
						</a>
						<a target="_blank" rel="noopener" class="w-fit shrink-0" href="https://team.indieseas.net">
							<Image
								src="/imgs/buttons/indiefellas.svg"
								alt="Indiefellas"
								title="indieweb devs with no idea what they're doing"
								width="88px" height="31px"
							/>
						</a>
						<a target="_blank" rel="noopener" class="w-fit shrink-0" href="https://nekoweb.org/"
							><Image
								src="https://nekoweb.org/assets/buttons/button5.gif"
								loading="lazy"
								alt="Nekoweb"
								title="Nekoweb (button by maxpixels)"
								width="88px" height="31px"
							/></a
						>
						<a href="https://districts.nekoweb.org/" target="_blank"><Image alt="Nekoweb Districts" title="Nekoweb Districts" src="https://districts.nekoweb.org/img/districts002.png" width="88px" height="31px"></a>
						<a target="_blank" class="w-fit shrink-0" href="https://kalechips.net/responsive/index">
							<Image
								src="/imgs/buttons/responsive-web-directory.png"
								alt="Responsive Web Directory"
								title="Responsive Web Directory"
								width="88px" height="31px"
							/>
						</a>
						<Image src="/imgs/buttons/mobilefriendly.png" alt="Mobile friendly" title="This site is mobile friendly!" width="88px" height="31px" />
					</div>
				</footer>
			</main>	
		</div>
		<style>
			body {
				display: flex;
				flex-direction: column;
			}
		
			header {
				display: flex;
				position: sticky;
				padding: 6px;
				gap: 6px;
				top: 0px;
				background: var(--acc);
				justify-self: start;
			}
		
			header > * {
				flex-grow: 1;
				  flex-basis: 0;
			}
		
			header > p {
				text-align: center;
				text-wrap-mode: nowrap;
				overflow: none;
				text-overflow: ellipsis;
				padding: 0px;
			}
		
			main {
				display: flex;
				flex-direction: column;
				justify-content: space-between;
				gap: 24px;
				padding: 0 12px;
			}
		
			footer {
				border-top: 1px solid var(--acc);
				padding-top: 4px;
				display: flex;
				justify-content: space-between;
			}
		
			footer .right {
				text-align: right;
				width: 300px;
			}
		
			.motd {
				writing-mode: vertical-rl;
				font-size: 0.85em;
				padding-right: 6px;
				padding-top: 10px;
				max-height: 250px;
			}
		
			@media (width > 640px) {
				header {
					display: none;
				}		
			}
		
			@media (width <= 800px) {
				footer .right {
					display: none;
				}
			}
		</style>
	</body>
</html>